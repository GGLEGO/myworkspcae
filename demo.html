<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>챗봇 AI 상담 데모</title>
    <link rel="stylesheet" href="style.css">
</head>
<body class="demo-page">

    <header class="demo-header">
        <h1><i class="fas fa-robot"></i> DB 기반 AI 상담 챗봇</h1>
        <p>Docker 서버 데이터베이스와 연동하여 실시간으로 정보를 학습하고 답변하는 AI 챗봇입니다.</p>
    </header>

    <main class="demo-content">
        <div class="left-panel">
            <section class="status-section">
                <h3><i class="fas fa-server"></i> 시스템 상태</h3>
                <div class="status-indicator-demo">
                    <div id="statusDot" class="status-dot"></div>
                    <span id="statusText">서버 상태 확인 중...</span>
                </div>
                <div>
                    <button class="test-btn" onclick="checkServerStatus()">상태 새로고침</button>
                    <button class="test-btn" onclick="testChatAPI()">채팅 API 테스트</button>
                </div>
                <pre id="testResult" class="test-result"></pre>
            </section>

            <section class="integration-code">
                <h3><i class="fas fa-code"></i> 내 웹사이트에 위젯 추가하기</h3>
                <p>아래 코드를 웹사이트의 `<body>` 태그가 끝나기 직전에 추가하세요.</p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyCode()"><i class="fas fa-copy"></i> 복사</button>
                    <pre id="integrationCode">&lt;!-- AI 챗봇 위젯 컨테이너 --&gt;
&lt;div id="workspace-chatbot" 
     data-server="http://localhost:3000"
     data-position="bottom-right"&gt;
&lt;/div&gt;

&lt;!-- AI 챗봇 위젯 스크립트 --&gt;
&lt;script src="http://localhost:3000/chatbot-widget.js"&gt;&lt;/script&gt;</pre>
                </div>
            </section>
        </div>

        <div class="right-panel">
            <div class="features">
                <div class="feature-card">
                    <h3><i class="fas fa-puzzle-piece"></i> 간편한 통합</h3>
                    <p>단 두 줄의 코드로 어떤 웹사이트에든 AI 챗봇을 쉽게 추가할 수 있습니다. 오른쪽 하단의 챗봇 아이콘을 클릭해보세요!</p>
                </div>
                <div class="feature-card">
                    <h3><i class="fas fa-sync-alt"></i> 실시간 학습</h3>
                    <p>서버의 `documents.json` 파일이 변경되면, 챗봇이 자동으로 내용을 다시 학습하여 항상 최신 정보를 답변합니다.</p>
                </div>
                 <div class="feature-card">
                    <h3><i class="fas fa-cogs"></i> 동적 UI 생성</h3>
                    <p>JavaScript가 챗봇 UI와 스타일을 동적으로 페이지에 주입하여, HTML 코드를 깔끔하게 유지할 수 있습니다.</p>
                </div>
            </div>
        </div>
    </main>

    <div id="workspace-chatbot" 
         data-server="http://localhost:3000"
         data-position="bottom-right">
         </div>

    <script src="http://localhost:3000/chatbot-widget.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', checkServerStatus);

        async function checkServerStatus() {
            const statusDot = document.getElementById('statusDot');
            const statusText = document.getElementById('statusText');
            const testResult = document.getElementById('testResult');
            
            if (!statusDot || !statusText || !testResult) return;
            
            statusText.textContent = '서버 상태 확인 중...';
            statusDot.className = 'status-dot';
            
            try {
                const response = await fetch('http://localhost:3000/status');
                if (!response.ok) throw new Error(`HTTP ${response.status}`);
                
                const data = await response.json();
                if (data.components && data.components.llm && data.components.vectorStore) {
                    statusDot.className = 'status-dot online';
                    statusText.textContent = '🟢 서버 온라인 - AI 시스템 준비됨';
                    testResult.style.display = 'block';
                    testResult.className = 'test-result success';
                    testResult.textContent = `✅ 서버 연결 성공! (문서 ${data.data.documentsCount}개 로드됨)`;
                } else {
                    throw new Error('AI 컴포넌트 준비 안됨');
                }
            } catch (error) {
                statusDot.className = 'status-dot offline';
                statusText.textContent = '🔴 서버 오프라인';
                testResult.style.display = 'block';
                testResult.className = 'test-result error';
                testResult.textContent = `❌ 서버 연결 실패: ${error.message}`;
            }
        }

        async function testChatAPI() {
            // ... (이전 chat.js의 testChatAPI 함수와 동일)
        }

        function copyCode() {
            // ... (이전 chat.js의 copyCode 함수와 동일)
        }
    </script>
</body>
</html>